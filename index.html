function calculateNPV(initialInvestment, cashFlows, r) {
    let npv = -initialInvestment; // start with negative initial investment
    for (let i = 0; i < cashFlows.length; i++) {
        npv += cashFlows[i] / Math.pow((1 + r), (i + 1)); // discount cash flows
    }
    return npv;
}

function calculateIRR(cashFlows, initialInvestment, guess = 0.1) {
    let npv = function(r) {
        let sum = -initialInvestment;
        for (let i = 0; i < cashFlows.length; i++) {
            sum += cashFlows[i] / Math.pow((1 + r), i + 1);
        }
        return sum;
    };

    let tolerance = 1e-6;
    let maxIterations = 1000;
    let iterations = 0;
    let rate = guess;

    while (iterations < maxIterations) {
        let npvValue = npv(rate);
        if (Math.abs(npvValue) < tolerance) {
            return rate;  // found a root
        }
        let derivative = (npv(rate + tolerance) - npv(rate)) / tolerance; // derivative using finite difference
        rate -= npvValue / derivative; // Newton-Raphson method
        iterations++;
    }
    throw new Error('IRR calculation did not converge.');
}